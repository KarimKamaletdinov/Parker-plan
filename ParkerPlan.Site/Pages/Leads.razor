@page "/leads/{Password}"
@using ParkerPlan.Abstractions
@using ParkerPlan.Abstractions.Dtos
@using ParkerPlan.Abstractions.Queries
@using ParkerPlan.Site.Data
@inject IQueryHandler<GetLeads, LeadDto[]> GetLeads
@inject PasswordService Service

@if (Password == Service.GetPassword())
{
    <MudTable Items="@GetLeads.Execute(new GetLeads())">
        <HeaderContent>
            <MudTh>Имя получателя</MudTh>
            <MudTh>Телефон</MudTh>
            <MudTh>Дата доставки</MudTh>
            <MudTh>Стоимость</MudTh>
            <MudTh>...</MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="Имя получателя">@context.CustomerName</MudTd>
            <MudTd DataLabel="Телефон">@context.CustomerPhone</MudTd>
            <MudTd DataLabel="Дата доставки">@context.DeliveryDate.ToLongDateString()</MudTd>
            <MudTd DataLabel="Стоимость">@context.FullPrice</MudTd>
            <MudTd DataLabel="...">
                <MudButton Link="@($"/lead/{context.Id}/{Password}")" />
            </MudTd>
        </RowTemplate>
    </MudTable>
}

@code
{
    [ParameterAttribute]
    public string Password { get; set; }
}
